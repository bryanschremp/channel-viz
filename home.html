<html>
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Home Temps</title>
  <style type="text/css">
    body {
      padding: 0;
      color: white;
      background-color: #000000;
      font-family: "Helvetica Neue", helvetica, arial, sans-serif;
      font-size: 20px;
    }
    .DateTime {
        width: 550px;
        text-align: right;
        font-size: 39px;
        padding: 3px;
    }

   .lbl{
      width: 370px;
      display:inline-block;
      text-align: right;
      font-size: 50px;
      text-shadow: 4px 4px 4px gray;
   }

   .val{
      display:inline-block;
      font-size: 70px;
      text-shadow: 4px 4px 4px gray;
   }

   .ValueDiv {
        width: 550px;
        padding: 2px;
        border: 2px solid;
        border-radius: 20px;
        background-color: DarkSlateBlue;
   }

   .TimestampDiv {
       width: 550px;
        text-align: right;
        font-size: 20px;
   }

   .data {
       display:inline-block;
   }

  </style>
</head>
<body onload="updateClock(); setInterval('updateClock()', 1000);">
    <div class="DateTime"><span id="Day"></span> <span id="Date"></span> <span id="CurrentTime"></span></div>
    <div class="ValueDiv">
        <div class="lbl">Indoor Temp</div>
        <div class="val">&nbsp;<span id="Indoor_Temp"></span>F</div>
    </div>
    <div class="ValueDiv">
        <div class="lbl">Indoor Humidity</div>
        <div class="val">&nbsp;<span id="Indoor_Humidity"></span>%</div>
    </div>
    <div class="ValueDiv">
        <div class="lbl">Outdoor Temp</div>
        <div class="val">&nbsp;<span id="Outdoor_Temp"></span>F</div>
    </div>
    <div class="ValueDiv">
        <div class="lbl">Outdoor Humidity</div>
        <div class="val">&nbsp;<span id="Outdoor_Humidity"></span>%</div>
    </div>
    <br />
    <br />
    <div class="TimestampDiv">
        <div class="data">Updated</div>
        <div class="data">&nbsp;<span id="Timestamp"> </span></div>
    </div>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="js/xivelyjs-1.0.0.min.js"></script>
    <script>
        var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

        $(document).ready(function ($) {
            xively.setKey("Po7EWwTloChQAz2HIJitKwCE8ivLVACilaIokUFo3e9459gc");

            var feedID = 1479543148;     // Feed ID
            var dt = new Date();
            document.getElementById("Day").innerHTML = days[dt.getDay()];
            document.getElementById("Date").innerHTML = dt.toLocaleDateString();

            xively.feed.get(feedID, function (feed) {

                $('#Timestamp').html(feed["updated"]);

                xively.feed.subscribe(feedID, "updated", function (event, feedUpdated) {
                    $('#Timestamp').html(feedUpdated["updated"]);
                });
            });

            xively.datastream.get(feedID, "Indoor_Temp", function (datastream) {

                $('#Indoor_Temp').html(datastream["current_value"]);

                xively.datastream.subscribe(feedID, "Indoor_Temp", function (event, datastream_updated) {
                    $('#Indoor_Temp').html(datastream_updated["current_value"]);
                });

            });

            xively.datastream.get(feedID, "Indoor_Humidity", function (datastream) {

                $('#Indoor_Humidity').html(datastream["current_value"]);

                xively.datastream.subscribe(feedID, "Indoor_Humidity", function (event, datastream_updated) {
                    $('#Indoor_Humidity').html(datastream_updated["current_value"]);
                });
            });

            xively.datastream.get(feedID, "Outdoor_Temp", function (datastream) {

                $('#Outdoor_Temp').html(datastream["current_value"]);

                xively.datastream.subscribe(feedID, "Outdoor_Temp", function (event, datastream_updated) {
                    $('#Outdoor_Temp').html(datastream_updated["current_value"]);
                });
            });

            xively.datastream.get(feedID, "Outdoor_Humidity", function (datastream) {

                $('#Outdoor_Humidity').html(datastream["current_value"]);

                xively.datastream.subscribe(feedID, "Outdoor_Humidity", function (event, datastream_updated) {
                    $('#Outdoor_Humidity').html(datastream_updated["current_value"]);
                });
            });

            // WARNING: Code here will continue executing while we get the datastream data from Xively,
            // use the function associated with datastream.get to work with the data
            // once the request is complete
        });

        function updateClock() {
            var currentTime = new Date();
            var currentHours = currentTime.getHours();
            var currentMinutes = currentTime.getMinutes();
            var currentSeconds = currentTime.getSeconds();

            // Pad the minutes and seconds with leading zeros, if required
            currentMinutes = (currentMinutes < 10 ? "0" : "") + currentMinutes;
            currentSeconds = (currentSeconds < 10 ? "0" : "") + currentSeconds;

            // Choose either "AM" or "PM" as appropriate
            var timeOfDay = (currentHours < 12) ? "AM" : "PM";

            // Convert the hours component to 12-hour format if needed
            currentHours = (currentHours > 12) ? currentHours - 12 : currentHours;

            // Convert an hours component of "0" to "12"
            currentHours = (currentHours == 0) ? 12 : currentHours;

            // Compose the string for display
            var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds + " " + timeOfDay;

            // Update the time display
            document.getElementById("CurrentTime").firstChild.nodeValue = currentTimeString;
        }
    </script>
</body>

</html>
