<html>
    <head><title>Home Temps</title>
    <meta http-equiv="refresh" content="500"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style type="text/css">
        *, *:before, *:after {
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }
        
        html {
            background: url('http://666a658c624a3c03a6b2-25cda059d975d2f318c03e90bcf17c40.r92.cf1.rackcdn.com/unsplash_52dd4720e8387_1.JPG') no-repeat center center fixed;
            background-size: cover;
        }
        
        body { 
            padding: 20px 40px 80px;
            font-family: 'Merriweather Sans', sans-serif;
            color: ghostwhite;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }
        
        .Dashboard {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .Widget {
            margin: 10px;
            box-shadow: 3px 3px 8px #333;
            text-align: center;
        }

        .Widget-header {
            padding: 10px 20px;
        }

        .Widget-headline {
          margin: 0;
        }
        
        /* Weather Widget */
        .WeatherWidget {
          display: flex;
          flex-direction: column;
          width: 380px;
          height: 300px;
          background: #239ED9;
        }

        .WeatherWidget .Widget-header {
          position: relative;
          display: flex;
          justify-content: flex-end;
          overflow: hidden;
          padding: 10px;
        }

        .WeatherWidget-primaryIcon {
          position: absolute;
          top: -50px;
          left: -50px;
          height: 120px;
          width: 120px;
          z-index: 1;
          /* opacity: .4; */
        }
        
        .WeatherWidget .Widget-body {
          display: flex;
          align-items: center;
          justify-content: center;
        }
        
        .WeatherWidget .Widget-headline {
          font-size: 4em;
          z-index: 0;
        }

        .WeatherWidget .Widget-body {
          flex: 1;
          background: darken(#5CC8E5, 8%);
          padding: 20px;
          font-weight: 300;
          font-size: 9em;
        }

        .WeatherWidget .Conditions-Text {
          flex: 1;
          display: flex;
          align-items: center;
        }
        
         /* DateWidget Widget */
        .DateWidget {
          display: flex;
          flex-direction: column;
          width: 380px;
          background: #68A691;
        }

        .DateWidget .Widget-header {
          flex: 1;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .DateWidget .Widget-body {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .DateWidget .Widget-headline {
          font-size: 4em;
        }

        .DateWidget .Widget-body {
          flex: 1;
          background: darken(#5CC8E5, 8%);
          padding: 20px;
          font-weight: 300;
          font-size: 4em;
        }
        
         /* TimeWidget Widget */
        .TimeWidget {
          display: flex;
          width: 1200px;
          height: 300px;
          background: #2180AC;
        }

        .TimeWidget .Widget-header {
          flex: 1;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .TimeWidget .Widget-headline {
            padding: 20px;
            font-weight: 700;
            font-size: 12em;
        }
        
        @import url(http://fonts.googleapis.com/css?family=Merriweather+Sans:300,400,700);
    </style>
</head>
<body onload="updateClock(); getTemps(); getWeather(); setInterval( 'updateClock()', 60000 ); setInterval( 'getTemps()', 300000 ); setInterval( 'getWeather()', 3000000 );">
<div class="Dashboard">
    <section class="Widget WeatherWidget">
        <header class="Widget-header">
            <img id="Conditions" src="http://icons.wxug.com/i/c/k/nt_clear.gif" alt="" class="WeatherWidget-primaryIcon"/>      
            <h2 class="Widget-headline">Outdoor</h2>
        </header>
        <div class="Widget-body">
            <p><span id="Outdoor_Temp"></span>F</p>
        </div>
    </section>
    
    <section class="Widget DateWidget">
        <header class="Widget-header">      
            <h2 class="Widget-headline"><span id="text_date"></span></h2>
        </header>
        <div class="Widget-body">
            <p></p>
        </div>
    </section>
    
    <section class="Widget WeatherWidget">
        <header class="Widget-header">      
            <h2 class="Widget-headline">Indoor</h2>
        </header>
        <div class="Widget-body">
            <p><span id="Indoor_Temp"></span>F</p>
        </div>
    </section>

    <section class="Widget TimeWidget">
        <header class="Widget-header">      
            <h2 class="Widget-headline"><span id="time"></span></h2>
        </header>
    </section>
    
    <!-- <section>
        <span id="outdoorRH"></span>
        <span id="indoorRH"></span>  
         <div class="Conditions-Text">
                <span id="Weather"></span>
            </div>
    </section> -->
</div>

    <script src='http://openweathermap.org/themes/openweathermap/assets/vendor/owm/js/d3.min.js'></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="js/xivelyjs-1.0.0.min.js"></script>
    <script>        
        function getTemps() {
            $.getJSON('http://api.thingspeak.com/channels/33195/feed/last.json?callback=?', function(data) {
                if(data.field1) { // If the field1 has data, update the page.
                    $('#Indoor_Temp').html(data.field1);
                    // $('#indoorRH').html(data.field2 + '%');
                }           
            } );
            
            $.getJSON('http://api.thingspeak.com/channels/21626/feed/last.json?callback=?', function(data)  {
                if(data.field1) { // If the field1 has data, update the page.
                    $('#Outdoor_Temp').html(parseInt(data.field1));
                    // $('#outdoorRH').html(parseInt(data.field2) + '%');
                }           
            } );
        }

        function updateClock() {
            var dt = new Date();
            var currentHours = dt.getHours();
            var currentMinutes = dt.getMinutes();
            
            // Pad the minutes and seconds with leading zeros, if required
            currentMinutes = (currentMinutes < 10 ? "0" : "") + currentMinutes;
            // Choose either "AM" or "PM" as appropriate
            var timeOfDay = (currentHours < 12) ? "AM" : "PM";
            // Convert the hours component to 12-hour format if needed
            currentHours = (currentHours > 12) ? currentHours - 12 : currentHours;
            // Convert an hours component of "0" to "12"
            currentHours = (currentHours == 0) ? 12 : currentHours;
            var currentTimeString = currentHours + ":" + currentMinutes + " " + timeOfDay;
            $( '#time' ).html(currentTimeString);
            
            var currentDateString = (dt.getMonth()+1) + "/" + dt.getDate() + "/" + dt.getFullYear();
            $( '#text_date' ).html(currentDateString);
        }

        function getWeather() {
            $.ajax({
                url : "http://api.wunderground.com/api/86cffc836a1c0a6a/conditions/q/pws:KWAWOODI62.json",
                dataType : "jsonp",
                success : function(parsed_json) {
                    var weather = parsed_json['current_observation']['weather'];
                    $('#Weather').html(weather);
                    
                    var icon_url = parsed_json['current_observation']['icon_url'];
                    // $( '#Conditions' ).html('<img src="' + icon_url + '" width=125 height=125>' );
                    $('#Conditions').attr("src", icon_url);
                }
            });
        }
    </script>
</body>
</html>
